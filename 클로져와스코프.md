1. 스코프(유효범위)

자바스크립트의 클로저를 알기 위해선 스코프에 대한 이해가 먼저 필요하다.

유효범위는 자바스크립트만이 아닌 모든 프로그래밍 언어에서 기본적인 개념이다.

 

1-1. 스코프란?

프로그래밍언어에서 유효범위(스코프)는 어느 범위까지 참조하는지를 뜻한다. 

좀더 자세히 정리하자면 변수이름, 함수이름, 클래스이름 과 같은 식별자가 본인이 선언된 위치에 따라 다른 코드에서 자신이 참조될 수 있을지 없을지 결정되는 것이다.

 

전역에서 선언되는지 지역에서 선언되는지에 따라 두가지 종류르 나뉜다.

1) 전역 스코프 (Global scope) : 스크립트 전체에서 참조 되는 것 (어느 곳에서든 참조 가능)

2) 지역 스코프 (Local scope) : 정의된 함수 내에서만 참조되는 것 (지역 밖에서는 참조 되지 않음)
1-2. 스코프 체인
3) ![image](https://user-images.githubusercontent.com/83463918/162764120-87df1d4f-7c9c-43d7-ae7c-cc052f8a3e37.png)
다음의 코드처럼 전역에도 지역에도 x 라는 변수가 있을때 함수는 어떤 값을 참조하는지 헷갈릴 때가 있다.

 

현재 코드의 구조는 전역 안의 외부함수 안의 중첩함수의 형태로 이루어져 있다. 

함수가 중첩이 되면 각각의 함수의 지역스코프 또한 중첩이 될 수 있는데, 이는 스코프가 함수의 중첩에 의해 계층적인 구조를 가질 수 있다는 것을 의미한다.
![image](https://user-images.githubusercontent.com/83463918/162764506-a33cdb41-4d1d-437f-963b-b02efa6a7f39.png)
inner 스코프의 상위는 outer, outer 스코프의 상위는 전역 스코프이다.

이처럼 스코프가 계층적으로 이루어져 있는 것을 스코프 체인이라고 한다.

 

자바스크립트 엔진이 변수를 참조할 때 스코프체인을 통해 변수를 참조한다.

가장 하위 스코프인 inner 에서 z 라는 변수를 참조하려고 한다.

![image](https://user-images.githubusercontent.com/83463918/163718418-7b1bba15-46df-4c07-8910-425bf4c02d96.png)

1) 이때 자바스크립트 엔진은 스코프 체인을 통해 먼저 inner 스코프의 안에서 z라는 변수를 찾게된다. 

2) inner 함수 내에는 z라는 변수가 없기 때문에 상위 스코프인 outer 스코프에서 z라는 변수를 찾게 된다.

3) outer 스코프 내에도 z는 없기 때문에 전역에서 찾게된다.

4) 전역에 또한 z라는 변수는 없기때문에 결국 Error 를 출력하게 된다.

 

이렇게 스코프 체인을 통해 변수를 참조할 때는 무조건 상위 스코프로만 올라간다.
